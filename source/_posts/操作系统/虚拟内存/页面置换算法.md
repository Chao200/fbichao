---
title: 页面置换算法
tags:
  - 页面置换
author: fbichao
categories: 
  - 操作系统
  - 虚拟内存
excerpt: 页面置换
math: true
date: 2024-03-30 20:45:00
---



# 页面置换算法

当 CPU 访问的页面不在物理内存时，便会产生一个缺页中断，请求操作系统将所缺页调入到物理内存

## 1. 最佳页面置换算法

> OPT, Optimal replacement algorithm

置换在「未来」最长时间不访问的页面。

是一种理论上的算法，因为无法知道一个页面多长时间不再被访问。

## 2. 最近最久未使用页面置换算法

> LRU, Least Recently Used

选择最长时间没有被访问的页面进行置换

为了实现 LRU，需要在内存中维护一个所有页面的链表。当一个页面被访问时，将这个页面移到链表表头。这样就能保证链表表尾的页面是最近最久未访问的。

因为每次访问都需要更新链表，因此这种方式实现的 LRU 代价很高。

```
4，7，0，7，1，0，1，2，1，2，6
```

![](https://file.fbichao.top/2024/03/4f12958e71be548f5cf7844c0408ae2e.png)

## 3. 最不常用页面置换算法

> LFU

当发生缺页中断时，选择「访问次数」最少的那个页面，并将其淘汰

## 4. 先进先出页面置换算法

> FIFO, First In First Out

选择换出的页面是最先进入的页面。

该算法会将那些经常被访问的页面换出，导致缺页率升高。贝拉蒂异常

## 5. 时钟页面置换算法

> Clock

页面使用环形链表存储，有一个访问位 R

缺页发生，指针指向最老的页，如果 R 为 1，则改为 0，移动指针；若 R 为 0，则换出

![](https://file.fbichao.top/2024/03/5d7223167fb2e6911fcdf6af5df64d89.png)


# 抖动

正在运行的内存需求超过了可用的物理内存，就会不断缺页中断进行换页——抖动

1. 置换策略有问题，那么换新的策略
2. 进程过多，关闭部分进程
3. 增加物理内存

# 总结

最理想的是页面置换算法是 **「最佳页面置换算法」**

置换在「未来」最长时间不访问的页面。但是我们无法预知未来

---

较为简单的置换算法是 **『FIFO』**

即置换最先被访问的页面，可能会产生贝拉蒂异常，即分配的页数增加，反而缺页率上升

与 FIFO 相似的是 **『随机算法』**，即随机选择页面置换

---

我们可以根据历史信息情况，选择最长时间没有被访问的页面进行置换，即 **LRU『最近最久未使用』**，缺点是每次页面访问都需要更新存储信息的数据结构

此外我们可以统计每个页面的访问次数，置换访问次数最少的页面，即 **LFU『最不常用页面置换算法』**，缺点是需要遍历找到次数最少的页面

---

由于实现 LRU 开销比较大，可以实现近似 LRU 的算法，

 **『时钟算法』**，我们对每个页面设置访问位，并用环形链表存储，如果 R 为 1，则改为 0，移动指针；若 R 为 0，则换出

我们还可以考虑脏页，因为脏页被修改了，置换时需要写回磁盘，代价比较高，而如果置换干净的页，则效率更高，所以除了访问位外，还可以设置脏位，优先选择未用使用的干净页置换，如果没有，继而选择未使用的脏页置换

---

当进程对内存的需求超过了物理内存，导致频发缺页中断，造成抖动现象，解决方法包括策略、关闭进程、增加物理内存